/**
 * ç¹ä½“ä¸­æ–‡è½¬ç®€ä½“ä¸­æ–‡è½¬æ¢è„šæœ¬
 * ä½œè€…: AI Assistant
 * æ—¥æœŸ: 2025-11-05
 */

import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// ç¹ç®€å¯¹ç…§è¡¨ - æŒ‰è¯ç»„ä¼˜å…ˆï¼Œå•å­—å…¶æ¬¡
const conversionMap = {
    // è¯ç»„ï¼ˆä¼˜å…ˆåŒ¹é…ï¼‰
    'ä»»å‹™': 'ä»»åŠ¡',
    'è³‡è¨Š': 'èµ„è®¯',
    'è³‡æ–™åº«': 'æ•°æ®åº“',
    'è³‡æ–™': 'èµ„æ–™',
    'æ¶æ§‹': 'æ¶æ„',
    'å°ˆæ¡ˆ': 'é¡¹ç›®',
    'çµæ§‹': 'ç»“æ„',
    'è­˜åˆ¥': 'è¯†åˆ«',
    'é¸æ“‡': 'é€‰æ‹©',
    'çµ„ä»¶': 'ç»„ä»¶',
    'çµ„ç¹”': 'ç»„ç»‡',
    'ç¯„åœ': 'èŒƒå›´',
    'åš´è¬¹': 'ä¸¥è°¨',
    'æ§‹å»º': 'æ„å»º',
    'æ§‹æƒ³': 'æ„æƒ³',
    'æ§‹é€ ': 'æ„é€ ',
    'çµ„': 'ç»„',
    'åº«': 'åº“',
    'çµ„ä»¶åº«': 'ç»„ä»¶åº“',
    'åŸ·è¡Œ': 'æ‰§è¡Œ',
    'å°ˆæ¡ˆ': 'é¡¹ç›®',
    'çµæ§‹': 'ç»“æ„',
    'çµ„ç¹”': 'ç»„ç»‡',
    'åŠƒåˆ†': 'åˆ’åˆ†',
    'é¡åˆ¥': 'ç±»åˆ«',
    'é—œä¿‚': 'å…³ç³»',
    'æ¨™è¨˜': 'æ ‡è®°',
    'è·è²¬': 'èŒè´£',
    'è¦å¾‹': 'è§„å¾‹',
    'è¦åŠƒ': 'è§„åˆ’',
    'è¦ç¯„': 'è§„èŒƒ',
    'ç¢ºèª': 'ç¡®è®¤',
    'ç¢ºå®š': 'ç¡®å®š',
    'ç¢ºä¿': 'ç¡®ä¿',
    'æŒ‘æˆ°': 'æŒ‘æˆ˜',
    'æ±ºç­–': 'å†³ç­–',
    'æª¢è¦–': 'æ£€è§†',
    'æª¢æŸ¥': 'æ£€æŸ¥',
    'è©³ç´°': 'è¯¦ç»†',
    'é–±è®€': 'é˜…è¯»',
    'åƒè€ƒ': 'å‚è€ƒ',
    'è¾¨è­˜': 'è¾¨è¯†',
    'è­˜åˆ¥': 'è¯†åˆ«',
    'è¨˜éŒ„': 'è®°å½•',
    'é‡æ¸…': 'å˜æ¸…',
    'æŸ¥è©¢': 'æŸ¥è¯¢',
    'ç¨‹å¼': 'ç¨‹åº',
    'æ†‘': 'å‡­',
    'è‡†æ¸¬': 'è‡†æµ‹',
    'ä¾†æº': 'æ¥æº',
    'å°‹æ‰¾': 'å¯»æ‰¾',
    'è¨ˆåŠƒ': 'è®¡åˆ’',
    'è¨ˆç®—': 'è®¡ç®—',
    'é¡å‹': 'ç±»å‹',
    'å„ªå…ˆ': 'ä¼˜å…ˆ',
    'å„ªåŒ–': 'ä¼˜åŒ–',
    'ä½ˆå±€': 'å¸ƒå±€',
    'çµ„åˆ': 'ç»„åˆ',
    'ç‹€æ…‹': 'çŠ¶æ€',
    'éŸ¿æ‡‰': 'å“åº”',
    'ç·©å­˜': 'ç¼“å­˜',
    'ç”¢å‡º': 'äº§å‡º',
    'æ¨™ç¤º': 'æ ‡ç¤º',
    'æ¨™æº–': 'æ ‡å‡†',
    'é¸æ“‡': 'é€‰æ‹©',
    'é¸': 'é€‰',
    'é ˆ': 'é¡»',
    'åš´é‡': 'ä¸¥é‡',
    'åš´æ ¼': 'ä¸¥æ ¼',
    'åš´ç¦': 'ä¸¥ç¦',
    'åš´è¬¹': 'ä¸¥è°¨',
    'å‡è¨­': 'å‡è®¾',
    'çŒœæ¸¬': 'çŒœæµ‹',
    'å¹»æƒ³': 'å¹»æƒ³',
    'é€é': 'é€šè¿‡',
    'æ”¶é›†': 'æ”¶é›†',
    'æ§‹æƒ³': 'æ„æƒ³',
    'æ§‹å»º': 'æ„å»º',
    'å‘¼å«': 'è°ƒç”¨',
    'èª¿ç”¨': 'è°ƒç”¨',
    'å°': 'å¯¼',
    'æ¢ä»¶': 'æ¡ä»¶',
    'åŠƒ': 'åˆ’',
    'ç¯„åœ': 'èŒƒå›´',
    'åƒ…': 'ä»…',
    'ç•°å¸¸': 'å¼‚å¸¸',
    'æ•ˆèƒ½': 'æ€§èƒ½',
    'è³‡æº': 'èµ„æº',
    'é©—è­‰': 'éªŒè¯',
    'å¹«åŠ©': 'å¸®åŠ©',
    'éç¨‹': 'è¿‡ç¨‹',
    'å¾©é›œ': 'å¤æ‚',
    'å¾Œç«¯': 'åç«¯',
    'è™•ç†': 'å¤„ç†',
    'å®Ÿç¾': 'å®ç°',
    'å®Ÿæ–½': 'å®æ–½',
    'å®Ÿä½œ': 'å®ä½œ',
    'é–‹å§‹': 'å¼€å§‹',
    'èª¬æ˜': 'è¯´æ˜',
    'èª­å–': 'è¯»å–',
    'é æœŸ': 'é¢„æœŸ',
    'é¡å¤–': 'é¢å¤–',
    'æ§˜å¼': 'æ ·å¼',
    'é¨“è¨¼': 'éªŒè¯',
    'ç¶™ç¶š': 'ç»§ç»­',
    'è¦³å¯Ÿ': 'è§‚å¯Ÿ',
    'è¨³æ–‡': 'è¯‘æ–‡',
    'è¨­è¨ˆ': 'è®¾è®¡',
    'è¨­å®š': 'è®¾å®š',
    'èª¿æ•´': 'è°ƒæ•´',
    'è¬¹æ…': 'è°¨æ…',
    'è®Šæ›´': 'å˜æ›´',
    'è³ªé‡': 'è´¨é‡',
    'é”æˆ': 'è¾¾æˆ',
    'å…§å®¹': 'å†…å®¹',
    'é€™': 'è¿™',
    'é€™äº›': 'è¿™äº›',
    'é€™å€‹': 'è¿™ä¸ª',
    'é€™æ¨£': 'è¿™æ ·',
    'é€²è¡Œ': 'è¿›è¡Œ',
    'é€²': 'è¿›',
    'å°': 'å¯¹',
    'å°æ–¼': 'å¯¹äº',
    'æ‡‰è©²': 'åº”è¯¥',
    'æ‡‰': 'åº”',
    'æœƒ': 'ä¼š',
    'å¾': 'ä»',
    'å€‹': 'ä¸ª',
    'ç‚º': 'ä¸º',
    'å¯¦': 'å®',
    'å¯¦ç¾': 'å®ç°',
    'å¯¦æ–½': 'å®æ–½',
    'å¯¦éš›': 'å®é™…',
    'å¯¦ä½œ': 'å®ä½œ',
    'èª¬': 'è¯´',
    'èª­': 'è¯»',
    'èˆ‡': 'ä¸',
    'ç¢º': 'ç¡®',
    'ç¾': 'ç°',
    'æ§˜': 'æ ·',
    'é¨“': 'éªŒ',
    'ç¶™': 'ç»§',
    'è¦': 'è§„',
    'è¦³': 'è§‚',
    'è¨³': 'è¯‘',
    'è¨­': 'è®¾',
    'è«‹': 'è¯·',
    'èª¿': 'è°ƒ',
    'è¬¹': 'è°¨',
    'è­°': 'è®®',
    'è®Š': 'å˜',
    'è³ª': 'è´¨',
    'é”': 'è¾¾',
    'é‚„': 'è¿˜',
    'é‚Š': 'è¾¹',
    'é©': 'é€‚',
    'éŒ„': 'å½•',
    'éŒ¯': 'é”™',
    'éµ': 'é”®',
    'é–‹': 'å¼€',
    'é—œ': 'å…³',
    'éš›': 'é™…',
    'éš¨': 'éš',
    'éšª': 'é™©',
    'é ': 'é¢„',
    'é ': 'é¡µ',
    'é¡': 'ç±»',
    'é¡¯': 'æ˜¾',
    'ä¸¦': 'å¹¶',
    'ç„¡': 'æ— ',
    'ç„¡æ³•': 'æ— æ³•',
    'ç„¡éœ€': 'æ— éœ€',
    'ç„¡': 'æ— ',
    'æ™‚': 'æ—¶',
    'æ™‚é–“': 'æ—¶é—´',
    'æ™‚å€™': 'æ—¶å€™',
    'å•é¡Œ': 'é—®é¢˜',
    'å•': 'é—®',
    'å–®': 'å•',
    'å–®å€‹': 'å•ä¸ª',
    'å–®å…ƒ': 'å•å…ƒ',
    'ç¸½': 'æ€»',
    'ç¸½çµ': 'æ€»ç»“',
    'ç¸½è¨ˆ': 'æ€»è®¡',
    'ç¸½é«”': 'æ€»ä½“',
    'ç¶“': 'ç»',
    'ç¶“é': 'ç»è¿‡',
    'ç¶“é©—': 'ç»éªŒ',
    'ç·š': 'çº¿',
    'ç¶': 'ç»‘',
    'ç¶­': 'ç»´',
    'ç¶­è­·': 'ç»´æŠ¤',
    'ç¶²': 'ç½‘',
    'ç¶²çµ¡': 'ç½‘ç»œ',
    'ç¶²è·¯': 'ç½‘ç»œ',
    'ç·’': 'ç»ª',
    'ç·¨': 'ç¼–',
    'ç·¨ç¢¼': 'ç¼–ç ',
    'ç·¨è™Ÿ': 'ç¼–å·',
    'ç·´': 'ç»ƒ',
    'ç¸®': 'ç¼©',
    'ç¸½': 'æ€»',
    'ç¹¼': 'ç»§',
    'ç¹¼çºŒ': 'ç»§ç»­',
    'çºŒ': 'ç»­',
    'çº–': 'çº¤',
    'ç½·': 'ç½¢',
    'ç¿’': 'ä¹ ',
    'è¯': 'è”',
    'è¯ç¹«': 'è”ç³»',
    'è²': 'å£°',
    'è‡¨': 'ä¸´',
    'èˆ‰': 'ä¸¾',
    'èˆŠ': 'æ—§',
    'ç¯€': 'èŠ‚',
    'ç¯„': 'èŒƒ',
    'ç¯‰': 'ç­‘',
    'ç°¡': 'ç®€',
    'ç°¡åŒ–': 'ç®€åŒ–',
    'ç°¡å–®': 'ç®€å•',
    'ç±¤': 'ç­¾',
    'é¡': 'ç±»',
    'çµ‚': 'ç»ˆ',
    'çµ„': 'ç»„',
    'çµ': 'ç»“',
    'çµ¦': 'ç»™',
    'çµ±': 'ç»Ÿ',
    'çµ±ä¸€': 'ç»Ÿä¸€',
    'çµ•': 'ç»',
    'çµ•å°': 'ç»å¯¹',
    'ç¹': 'ç»•',
    'ç¹ª': 'ç»˜',
    'è­‰': 'è¯',
    'è­‰æ˜': 'è¯æ˜',
    'è­˜': 'è¯†',
    'è­¯': 'è¯‘',
    'è­°': 'è®®',
    'è­·': 'æŠ¤',
    'è®€': 'è¯»',
    'è®Š': 'å˜',
    'è®“': 'è®©',
    'è±': 'ä¸°',
    'è² ': 'è´Ÿ',
    'è²«': 'è´¯',
    'è²¬': 'è´£',
    'è³´': 'èµ–',
    'è³´': 'èµ–',
    'è´Š': 'èµ',
    'è¶¨': 'è¶‹',
    'è·¡': 'è¿¹',
    'è¼ƒ': 'è¾ƒ',
    'è¼‰': 'è½½',
    'è¼¸': 'è¾“',
    'è¼¸å…¥': 'è¾“å…¥',
    'è¼¸å‡º': 'è¾“å‡º',
    'è½‰': 'è½¬',
    'è½‰æ›': 'è½¬æ¢',
    'è½‰ç§»': 'è½¬ç§»',
    'è¾¦': 'åŠ',
    'è¾²': 'å†œ',
    'é”': 'è¾¾',
    'é•': 'è¿',
    'é‹': 'è¿',
    'é‹è¡Œ': 'è¿è¡Œ',
    'é': 'è¿‡',
    'é©': 'é€‚',
    'é²': 'è¿Ÿ',
    'é·': 'è¿',
    'é¸': 'é€‰',
    'éº': 'é—',
    'é‚': 'é€»',
    'é‚è¼¯': 'é€»è¾‘',
    'é‚„': 'è¿˜',
    'é„°': 'é‚»',
    'é…': 'é…',
    'é†«': 'åŒ»',
    'æ¡': 'é‡‡',
    'éˆ': 'é“¾',
    'éˆæ¥': 'é“¾æ¥',
    'éŒ„': 'å½•',
    'éŒ¯': 'é”™',
    'éŒ¯èª¤': 'é”™è¯¯',
    'éµ': 'é”®',
    'é–': 'é”',
    'é˜': 'é’Ÿ',
    'é•·': 'é•¿',
    'é–€': 'é—¨',
    'é–‹': 'å¼€',
    'é–‰': 'é—­',
    'é–“': 'é—´',
    'é—œ': 'å…³',
    'é—¡': 'é˜',
    'é™£': 'é˜µ',
    'é™¸': 'é™†',
    'é™³': 'é™ˆ',
    'é™¤': 'é™¤',
    'é™°': 'é˜´',
    'é™½': 'é˜³',
    'éšŠ': 'é˜Ÿ',
    'éš': 'é˜¶',
    'éšæ®µ': 'é˜¶æ®µ',
    'éš¨': 'éš',
    'éšª': 'é™©',
    'éš±': 'éš',
    'éš¸': 'éš¶',
    'é›™': 'åŒ',
    'é›œ': 'æ‚',
    'é›¢': 'ç¦»',
    'é›£': 'éš¾',
    'é›»': 'ç”µ',
    'é›»è…¦': 'ç”µè„‘',
    'éœ€': 'éœ€',
    'é': 'é',
    'éœ': 'é™',
    'éŸ¿': 'å“',
    'é ‚': 'é¡¶',
    'é ': 'é¡µ',
    'é …': 'é¡¹',
    'é †': 'é¡º',
    'é ˆ': 'é¡»',
    'é ': 'é¢„',
    'é »': 'é¢‘',
    'é¡Œ': 'é¢˜',
    'é¡': 'ç±»',
    'é¡§': 'é¡¾',
    'é¡¯': 'æ˜¾',
    'é¢¨': 'é£',
    'é£›': 'é£',
    'é¤˜': 'ä½™',
    'é¤¨': 'é¦†',
    'é§': 'é©»',
    'é©…': 'é©±',
    'é©—': 'éªŒ',
    'é«”': 'ä½“',
    'é«”ç³»': 'ä½“ç³»',
    'é«®': 'å‘',
    'é¬¥': 'æ–—',
    'é®®': 'é²œ',
    'é»': 'ç‚¹',
    'é»¨': 'å…š',
    'é½Š': 'é½',
    'é½¡': 'é¾„',
    'é¾': 'é¾™',
    'é¾': 'åº',
    'é¾œ': 'é¾Ÿ',
};

// è½¬æ¢å‡½æ•° - æŒ‰è¯ç»„é•¿åº¦æ’åºåè½¬æ¢ï¼ˆé•¿çš„ä¼˜å…ˆï¼‰
function convertToSimplified(text) {
    let result = text;

    // æŒ‰é”®é•¿åº¦é™åºæ’åºï¼Œç¡®ä¿é•¿è¯ç»„ä¼˜å…ˆåŒ¹é…
    const sortedEntries = Object.entries(conversionMap).sort((a, b) => b[0].length - a[0].length);

    // ä½¿ç”¨å¯¹ç…§è¡¨è¿›è¡Œè½¬æ¢
    for (const [traditional, simplified] of sortedEntries) {
        const regex = new RegExp(traditional.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
        result = result.replace(regex, simplified);
    }

    return result;
}

// å¤„ç†å•ä¸ªæ–‡ä»¶
async function processFile(filePath) {
    try {
        const content = fs.readFileSync(filePath, 'utf8');
        const converted = convertToSimplified(content);

        // åªæœ‰å†…å®¹å˜åŒ–æ—¶æ‰å†™å…¥
        if (content !== converted) {
            fs.writeFileSync(filePath, converted, 'utf8');
            console.log(`âœ… å·²è½¬æ¢: ${filePath}`);
            return true;
        } else {
            console.log(`â­ï¸  è·³è¿‡ (æ— éœ€è½¬æ¢): ${filePath}`);
            return false;
        }
    } catch (error) {
        console.error(`âŒ å¤„ç†å¤±è´¥ ${filePath}:`, error.message);
        return false;
    }
}

// é€’å½’è·å–ç›®å½•ä¸‹æ‰€æœ‰ .md æ–‡ä»¶
function getAllMarkdownFiles(dir, fileList = []) {
    const files = fs.readdirSync(dir);

    files.forEach(file => {
        const filePath = path.join(dir, file);
        const stat = fs.statSync(filePath);

        if (stat.isDirectory()) {
            getAllMarkdownFiles(filePath, fileList);
        } else if (file.endsWith('.md')) {
            fileList.push(filePath);
        }
    });

    return fileList;
}

// ä¸»å‡½æ•°
async function main() {
    console.log('ğŸš€ å¼€å§‹ç¹ä½“è½¬ç®€ä½“è½¬æ¢...\n');

    const targetDir = path.join(__dirname, 'src', 'prompts', 'templates_zh');

    if (!fs.existsSync(targetDir)) {
        console.error(`âŒ ç›®å½•ä¸å­˜åœ¨: ${targetDir}`);
        process.exit(1);
    }

    // è·å–æ‰€æœ‰ .md æ–‡ä»¶
    const files = getAllMarkdownFiles(targetDir);

    console.log(`ğŸ“‚ æ‰¾åˆ° ${files.length} ä¸ªæ–‡ä»¶\n`);

    let convertedCount = 0;
    let skippedCount = 0;

    for (const file of files) {
        const converted = await processFile(file);
        if (converted) {
            convertedCount++;
        } else {
            skippedCount++;
        }
    }

    console.log('\n' + '='.repeat(50));
    console.log(`âœ¨ è½¬æ¢å®Œæˆï¼`);
    console.log(`   - å·²è½¬æ¢: ${convertedCount} ä¸ªæ–‡ä»¶`);
    console.log(`   - å·²è·³è¿‡: ${skippedCount} ä¸ªæ–‡ä»¶`);
    console.log(`   - æ€»è®¡: ${files.length} ä¸ªæ–‡ä»¶`);
    console.log('='.repeat(50));
}

// æ‰§è¡Œ
main().catch(console.error);

